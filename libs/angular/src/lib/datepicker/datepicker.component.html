<div class="form-group">
  <label *ngIf="label" [for]="id">{{ label }}</label>
  <div class="group" #datepickerElRef>
    <input
      [attr.id]="id"
      type="text"
      placeholder="yyyy-mm-dd"
      #dateInputElRef
      [value]="data?.formattedSelectedDate || ''"
      (change)="dp?.select(dateInputElRef.value)"
    />
    <button
      #datepickerTriggerElRef
      (click)="dp?.toggle()"
      type="button"
      class="primary"
    >
      <i class="sg-icon sg-icon-calendar">Select date</i>
    </button>
  </div>
  <ng-content></ng-content>
</div>
<!-- TODO: get or set attributes from within datepicker instance (dp) -->
<div
  #datepickerDialogElRef
  class="sg-date"
  [class.active]="dp?.state?.isActive"
  role="dialog"
  aria-modal="true"
  aria-label="Choose Date"
>
  <header>
    <button type="button" class="link" (click)="dp?.sub(1, 'months')">
      <i class="sg-icon sg-icon-previous">Previous month</i>
    </button>
    <ngg-dropdown
      [options]="months"
      text="Select"
      [value]="data?.month"
      (valueChange)="dp?.setMonth($event)"
    ></ngg-dropdown>
    <ngg-dropdown
      [options]="years"
      text="Select"
      [value]="data?.year"
      (valueChange)="dp?.setYear($event)"
    ></ngg-dropdown>
    <button type="button" class="link" (click)="dp?.add(1, 'months')">
      <i class="sg-icon sg-icon-next">Next month</i>
    </button>
  </header>
  <main>
    <table role="grid">
      <thead>
        <tr>
          <th scope="col" abbr="Monday">Mon</th>
          <th scope="col" abbr="Tuesday">Tue</th>
          <th scope="col" abbr="Wednesday">Wed</th>
          <th scope="col" abbr="Thursday">Thu</th>
          <th scope="col" abbr="Friday">Fri</th>
          <th scope="col" abbr="Saturday">Sat</th>
          <th scope="col" abbr="Sunday">Sun</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let week of data?.calendar; trackBy: trackWeek">
          <td
            *ngFor="let day of week"
            [attr.data-date]="day.formattedDate"
            [attr.role]="day.selected ? 'gridcell' : null"
            [attr.aria-selected]="day.selected ? true : null"
            [class.disabled]="!day.currentMonth"
            [class.sg-date-today]="day.today"
            [title]="day.today ? 'Today' : ''"
            tabindex="-1"
            (click)="day.currentMonth && dp?.select(day.date)"
          >
            {{ day.day }}
          </td>
        </tr>
      </tbody>
    </table>
  </main>
</div>
